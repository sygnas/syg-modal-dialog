{"version":3,"file":"syg-modal-dialog.umd.js","sources":["../src/js/SygModalUI.ts","../src/js/loaders/youtubeLoader.ts","../src/js/loaders/imageLoader.ts","../src/js/loaders/ajaxLoader.ts","../src/js/loaders/selectorLoader.ts","../src/js/loaders/htmlLoader.ts","../src/js/SygModalDialog.ts"],"sourcesContent":["/**\n * SygModalUI\n * モーダルダイアログのUI層\n * <dialog>要素のDOM生成・管理を担当\n */\n\nimport type { TModalUIOption, TModalDialogType, TModalLoadingState } from './types';\n\nexport class SygModalUI {\n  private dialog: HTMLDialogElement;\n  private container: HTMLElement;\n  private content: HTMLElement;\n  private loading: HTMLElement;\n  private options: {\n    closeButtonContent: string;\n    loadingContent: string;\n    modalClass: string;\n    containerClass: string;\n    contentClass: string;\n    closeBtnClass: string;\n    loadingClass: string;\n    onOpen?: () => void;\n    onClose?: () => void;\n  };\n  \n  public static defaultOptions = {\n    closeButtonContent: '×',\n    loadingContent: '',\n    modalClass: 'c-modal',\n    containerClass: 'c-modal__container',\n    contentClass: 'c-modal__content',\n    closeBtnClass: 'c-modal__close-btn',\n    loadingClass: 'c-modal__loading',\n  };\n\n  constructor(options: TModalUIOption = {}) {\n    this.options = {\n      ...SygModalUI.defaultOptions,\n      ...options,\n    };\n\n    // dialog要素を作成\n    this.dialog = this.createDialog();\n    this.container = this.dialog.querySelector(`#syg-modal-container`) as HTMLElement;\n    this.content = this.dialog.querySelector(`#syg-modal-content`) as HTMLElement;\n    this.loading = this.dialog.querySelector(`#syg-modal-loading`) as HTMLElement;\n\n    // イベントリスナーを設定\n    this.setupEventListeners();\n  }\n\n  /**\n   * dialog要素を作成\n   */\n  private createDialog(): HTMLDialogElement {\n    const dialog = document.createElement('dialog');\n    dialog.id = 'syg-modal-dialog';\n    dialog.className = this.options.modalClass;\n\n    const container = document.createElement('div');\n    container.id = 'syg-modal-container';\n    container.className = this.options.containerClass;\n\n    const content = document.createElement('div');\n    content.id = 'syg-modal-content';\n    content.className = this.options.contentClass;\n\n    const form = document.createElement('form');\n    form.method = 'dialog';\n\n    const closeBtn = document.createElement('button');\n    closeBtn.type = 'submit';\n    closeBtn.className = this.options.closeBtnClass;\n    closeBtn.innerHTML = this.options.closeButtonContent;\n\n    form.appendChild(closeBtn);\n\n    const loading = document.createElement('div');\n    loading.id = 'syg-modal-loading';\n    loading.className = this.options.loadingClass;\n    loading.setAttribute('data-state', 'init');\n    loading.innerHTML = this.options.loadingContent;\n\n    container.appendChild(content);\n    dialog.appendChild(container);\n    dialog.appendChild(form);\n    dialog.appendChild(loading);\n\n    return dialog;\n  }\n\n  /**\n   * イベントリスナーを設定\n   */\n  private setupEventListeners(): void {\n    // 背景クリックで閉じる\n    this.dialog.addEventListener('click', (ev) => {\n      if (ev.target === this.dialog) {\n        this.close();\n      }\n    });\n\n    // closeイベント\n    this.dialog.addEventListener('close', () => {\n      // スクロールを戻す\n      document.documentElement.style.overflow = '';\n      document.documentElement.style.height = '';\n\n      // onCloseコールバック\n      if (this.options.onClose) {\n        this.options.onClose();\n      }\n    });\n  }\n\n  /**\n   * モーダルを開く\n   */\n  open(): void {\n    // bodyに追加（まだ追加されていない場合）\n    if (!this.dialog.parentElement) {\n      document.body.appendChild(this.dialog);\n    }\n\n    // モーダルを表示\n    this.dialog.showModal();\n\n    // 背景スクロールを止める\n    document.documentElement.style.overflow = 'hidden';\n    document.documentElement.style.height = '100vh';\n\n    // onOpenコールバック\n    if (this.options.onOpen) {\n      this.options.onOpen();\n    }\n  }\n\n  /**\n   * モーダルを閉じる\n   */\n  close(): void {\n    this.dialog.close();\n  }\n\n  /**\n   * コンテンツを設定\n   */\n  setContent(html: string): void {\n    this.content.innerHTML = html;\n  }\n\n  /**\n   * ローディング状態を設定\n   */\n  setLoadingState(state: TModalLoadingState): void {\n    this.loading.setAttribute('data-state', state);\n  }\n\n  /**\n   * タイプを設定（data属性とクラス名を更新）\n   */\n  setType(type: TModalDialogType): void {\n    this.dialog.setAttribute('data-syg-modal-type', type);\n    \n    // ajax/selectorの場合はcontentClassを適用、それ以外は削除\n    if (type === 'ajax' || type === 'selector') {\n      this.content.className = this.options.contentClass;\n    } else {\n      this.content.className = '';\n    }\n  }\n\n  /**\n   * dialog要素を取得\n   */\n  getDialog(): HTMLDialogElement {\n    return this.dialog;\n  }\n\n  /**\n   * container要素を取得\n   */\n  getContainer(): HTMLElement {\n    return this.container;\n  }\n\n  /**\n   * content要素を取得\n   */\n  getContent(): HTMLElement {\n    return this.content;\n  }\n\n  /**\n   * loading要素を取得\n   */\n  getLoading(): HTMLElement {\n    return this.loading;\n  }\n\n  /**\n   * モーダルが開いているかどうか\n   */\n  isOpen(): boolean {\n    return this.dialog.open;\n  }\n\n  /**\n   * リソースを破棄\n   */\n  destroy(): void {\n    if (this.dialog.parentElement) {\n      this.dialog.remove();\n    }\n  }\n}\n","/**\n * YouTube動画ローダー\n */\n\n/**\n * YouTube動画を読み込み\n */\nexport async function loadYoutube(src: string, content: HTMLElement): Promise<void> {\n  const videoId = extractYoutubeId(src);\n\n  if (!videoId) {\n    throw new Error('YouTube動画IDを取得できませんでした');\n  }\n\n  const iframe = document.createElement('iframe');\n  iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;\n  iframe.width = '560';\n  iframe.height = '315';\n  iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';\n  iframe.allowFullscreen = true;\n  iframe.style.maxWidth = '100%';\n\n  content.innerHTML = '';\n  content.appendChild(iframe);\n}\n\n/**\n * YouTube動画IDを抽出\n */\nfunction extractYoutubeId(url: string): string | null {\n  // youtube.com/watch?v=VIDEO_ID\n  let match = url.match(/[?&]v=([^&]+)/);\n  if (match?.[1]) return match[1];\n\n  // youtu.be/VIDEO_ID\n  match = url.match(/youtu\\.be\\/([^?&]+)/);\n  if (match?.[1]) return match[1];\n\n  // youtube.com/embed/VIDEO_ID\n  match = url.match(/youtube\\.com\\/embed\\/([^?&]+)/);\n  if (match?.[1]) return match[1];\n\n  return null;\n}\n","/**\n * 画像ローダー\n * ズーム・ドラッグ機能付き\n */\n\nexport type ImageDragListeners = {\n  startDrag: (e: MouseEvent) => void;\n  doDrag: (e: MouseEvent) => void;\n  endDrag: (e: MouseEvent) => void;\n  touchStart: (e: TouchEvent) => void;\n  touchMove: (e: TouchEvent) => void;\n  touchEnd: (e: TouchEvent) => void;\n  onResizeHandler: () => void;\n  rafId: number | null;\n};\n\n/**\n * 画像を読み込み\n */\nexport async function loadImage(\n  src: string,\n  content: HTMLElement,\n  dialog: HTMLDialogElement,\n  container: HTMLElement\n): Promise<ImageDragListeners> {\n  return new Promise((resolve, reject) => {\n    const img = document.createElement('img');\n    img.style.cursor = 'pointer';\n\n    img.onload = () => {\n      // naturalWidth/Heightを取得\n      const naturalWidth = img.naturalWidth;\n      const naturalHeight = img.naturalHeight;\n\n      // syg-modal-dialog のサイズを取得\n      const dialogWidth = dialog.clientWidth;\n      const dialogHeight = dialog.clientHeight;\n\n      // 画像がdialogに収まるようにcontainerのサイズを計算（object-fit:contain相当）\n      // ただし、画像が小さい場合は拡大しない\n      const aspectRatio = naturalWidth / naturalHeight;\n      const dialogRatio = dialogWidth / dialogHeight;\n\n      let containerWidth: number;\n      let containerHeight: number;\n\n      if (aspectRatio > dialogRatio) {\n        // 横長の画像\n        containerWidth = Math.min(dialogWidth, naturalWidth);\n        containerHeight = containerWidth / aspectRatio;\n      } else {\n        // 縦長の画像\n        containerHeight = Math.min(dialogHeight, naturalHeight);\n        containerWidth = containerHeight * aspectRatio;\n      }\n\n      // containerのサイズと中央配置\n      container.style.width = `${containerWidth}px`;\n      container.style.height = `${containerHeight}px`;\n      container.style.left = `${(dialogWidth - containerWidth) / 2}px`;\n      container.style.top = `${(dialogHeight - containerHeight) / 2}px`;\n      container.style.transformOrigin = '0 0';\n\n      // ズーム・ドラッグ用の変数\n      let isZoomed = false;\n      let translateX = 0;\n      let translateY = 0;\n      let scale = 1;\n      let isDragging = false;\n      let dragStartX = 0;\n      let dragStartY = 0;\n      let mouseDownX = 0;\n      let mouseDownY = 0;\n      let dragStartTranslateX = 0;\n      let dragStartTranslateY = 0;\n      let rafId: number | null = null;\n      let pendingTranslateX = 0;\n      let pendingTranslateY = 0;\n      let lastTouchTime = 0; // タッチイベント発火時刻を記録\n\n      // matrixを適用する関数\n      const applyTransform = () => {\n        // matrix(scaleX, skewY, skewX, scaleY, translateX, translateY)\n        container.style.transform = `matrix(${scale}, 0, 0, ${scale}, ${translateX}, ${translateY})`;\n      };\n\n      // requestAnimationFrameを使った更新\n      const updateTransform = () => {\n        translateX = pendingTranslateX;\n        translateY = pendingTranslateY;\n        applyTransform();\n        rafId = null;\n      };\n\n      // マウスダウン\n      const onMouseDown = (e: MouseEvent) => {\n        // タッチイベントの直後（500ms以内）ならマウスイベントを無視\n        if (Date.now() - lastTouchTime < 500) {\n          return;\n        }\n        \n        if (e.target !== container && e.target !== img) return;\n\n        isDragging = true;\n        mouseDownX = e.clientX;\n        mouseDownY = e.clientY;\n        dragStartX = e.clientX;\n        dragStartY = e.clientY;\n        dragStartTranslateX = translateX;\n        dragStartTranslateY = translateY;\n        container.style.cursor = isZoomed ? 'grabbing' : 'pointer';\n      };\n\n      // タッチスタート\n      const onTouchStart = (e: TouchEvent) => {\n        if (e.target !== container && e.target !== img) return;\n        if (e.touches.length !== 1) return;\n\n        lastTouchTime = Date.now(); // タッチ時刻を記録\n        e.preventDefault(); // デフォルト動作を防止（クリックイベントの発火を防ぐ）\n        const touch = e.touches[0];\n        if (!touch) return;\n        isDragging = true;\n        mouseDownX = touch.clientX;\n        mouseDownY = touch.clientY;\n        dragStartX = touch.clientX;\n        dragStartY = touch.clientY;\n        dragStartTranslateX = translateX;\n        dragStartTranslateY = translateY;\n      };\n\n      // マウスムーブ\n      const onMouseMove = (e: MouseEvent) => {\n        if (!isDragging) return;\n\n        const deltaX = e.clientX - dragStartX;\n        const deltaY = e.clientY - dragStartY;\n\n        // ズーム時のみドラッグで移動\n        if (isZoomed) {\n          pendingTranslateX = dragStartTranslateX + deltaX;\n          pendingTranslateY = dragStartTranslateY + deltaY;\n          \n          // requestAnimationFrameが未実行なら予約\n          if (rafId === null) {\n            rafId = requestAnimationFrame(updateTransform);\n          }\n        }\n      };\n\n      // タッチムーブ\n      const onTouchMove = (e: TouchEvent) => {\n        if (!isDragging) return;\n        if (e.touches.length !== 1) return;\n\n        const touch = e.touches[0];\n        if (!touch) return;\n        const deltaX = touch.clientX - dragStartX;\n        const deltaY = touch.clientY - dragStartY;\n\n        // ズーム時のみドラッグで移動\n        if (isZoomed) {\n          e.preventDefault(); // スクロール防止\n          pendingTranslateX = dragStartTranslateX + deltaX;\n          pendingTranslateY = dragStartTranslateY + deltaY;\n          \n          // requestAnimationFrameが未実行なら予約\n          if (rafId === null) {\n            rafId = requestAnimationFrame(updateTransform);\n          }\n        }\n      };\n\n      // 共通: ズーム処理\n      const performZoom = (clientX: number, clientY: number) => {\n        isZoomed = true;\n        scale = naturalWidth / containerWidth;\n\n        // dialog の位置\n        const dialogRect = dialog.getBoundingClientRect();\n        \n        // クリック位置（dialog内の座標）\n        const clickXInDialog = clientX - dialogRect.left;\n        const clickYInDialog = clientY - dialogRect.top;\n\n        // containerの左上座標（dialog内、transform適用前の位置）\n        const containerLeft = parseFloat(container.style.left);\n        const containerTop = parseFloat(container.style.top);\n\n        // クリック位置（container内の座標）\n        const clickXInContainer = clickXInDialog - containerLeft;\n        const clickYInContainer = clickYInDialog - containerTop;\n        \n        translateX = clickXInContainer * (1 - scale);\n        translateY = clickYInContainer * (1 - scale);\n\n        container.style.cursor = 'grab';\n        applyTransform();\n      };\n\n      // 共通: ズーム解除処理\n      const performZoomOut = () => {\n        isZoomed = false;\n        scale = 1;\n        translateX = 0;\n        translateY = 0;\n        container.style.cursor = 'pointer';\n        applyTransform();\n      };\n\n      // 共通: クリック/タップ終了処理\n      const handlePointerUp = (clientX: number, clientY: number) => {\n        if (!isDragging) return;\n\n        // 保留中のアニメーションフレームをキャンセル\n        if (rafId !== null) {\n          cancelAnimationFrame(rafId);\n          rafId = null;\n        }\n\n        const moveDistance = Math.sqrt(\n          Math.pow(clientX - mouseDownX, 2) + Math.pow(clientY - mouseDownY, 2)\n        );\n\n        // 5px未満の移動ならクリック/タップとみなす\n        if (moveDistance < 5) {\n          if (isZoomed) {\n            performZoomOut();\n          } else {\n            performZoom(clientX, clientY);\n          }\n        } else {\n          // ドラッグ終了時に最終位置を反映\n          translateX = pendingTranslateX;\n          translateY = pendingTranslateY;\n        }\n\n        isDragging = false;\n        if (isZoomed) {\n          container.style.cursor = 'grab';\n        }\n      };\n\n      // マウスアップ\n      const onMouseUp = (e: MouseEvent) => {\n        handlePointerUp(e.clientX, e.clientY);\n      };\n\n      // ウィンドウリサイズ時の処理\n      const onResize = () => {\n        // ズーム中はリサイズ処理をスキップ\n        if (isZoomed) return;\n\n        // dialog の新しいサイズを取得\n        const newDialogWidth = dialog.clientWidth;\n        const newDialogHeight = dialog.clientHeight;\n\n        // containerのサイズを再計算\n        const aspectRatio = naturalWidth / naturalHeight;\n        const dialogRatio = newDialogWidth / newDialogHeight;\n\n        let newContainerWidth: number;\n        let newContainerHeight: number;\n\n        if (aspectRatio > dialogRatio) {\n          // 横長の画像\n          newContainerWidth = Math.min(newDialogWidth, naturalWidth);\n          newContainerHeight = newContainerWidth / aspectRatio;\n        } else {\n          // 縦長の画像\n          newContainerHeight = Math.min(newDialogHeight, naturalHeight);\n          newContainerWidth = newContainerHeight * aspectRatio;\n        }\n\n        // containerを中央に配置\n        container.style.width = `${newContainerWidth}px`;\n        container.style.height = `${newContainerHeight}px`;\n        container.style.left = `${(newDialogWidth - newContainerWidth) / 2}px`;\n        container.style.top = `${(newDialogHeight - newContainerHeight) / 2}px`;\n\n        // containerWidth/Heightを更新（ズーム時の計算に使用）\n        containerWidth = newContainerWidth;\n        containerHeight = newContainerHeight;\n      };\n\n      // タッチエンド\n      const onTouchEnd = (e: TouchEvent) => {\n        if (!isDragging) return;\n        e.preventDefault(); // デフォルト動作を防止（クリックイベントの発火を防ぐ）\n        const touch = e.changedTouches[0];\n        if (!touch) return;\n        handlePointerUp(touch.clientX, touch.clientY);\n      };\n\n      // イベントリスナーを追加\n      container.addEventListener('mousedown', onMouseDown);\n      container.addEventListener('touchstart', onTouchStart, { passive: false });\n      document.addEventListener('mousemove', onMouseMove);\n      document.addEventListener('touchmove', onTouchMove, { passive: false });\n      document.addEventListener('mouseup', onMouseUp);\n      document.addEventListener('touchend', onTouchEnd);\n      document.addEventListener('touchcancel', onTouchEnd);\n      window.addEventListener('resize', onResize);\n\n      // 画像をコンテンツに追加\n      content.innerHTML = '';\n      content.appendChild(img);\n\n      // ドラッグリスナーを返す\n      resolve({\n        startDrag: onMouseDown,\n        doDrag: onMouseMove,\n        endDrag: onMouseUp,\n        touchStart: onTouchStart,\n        touchMove: onTouchMove,\n        touchEnd: onTouchEnd,\n        onResizeHandler: onResize,\n        rafId,\n      });\n    };\n\n    img.onerror = () => reject(new Error('画像の読み込みに失敗しました'));\n\n    img.src = src;\n  });\n}\n","/**\n * Ajax コンテンツローダー\n */\n\n/**\n * Ajaxでコンテンツを読み込み\n */\nexport async function loadAjax(src: string, content: HTMLElement): Promise<void> {\n  const response = await fetch(src);\n\n  if (!response.ok) {\n    throw new Error(`HTTP error! status: ${response.status}`);\n  }\n\n  const html = await response.text();\n  content.innerHTML = html;\n}\n","/**\n * セレクタコンテンツローダー\n */\n\n/**\n * セレクタで指定した要素のコンテンツを読み込み\n */\nexport function loadSelector(src: string, content: HTMLElement): void {\n  const element = document.querySelector(src);\n\n  if (!element) {\n    throw new Error(`要素が見つかりません: ${src}`);\n  }\n\n  content.innerHTML = element.innerHTML;\n}\n","/**\n * HTML文字列を直接表示するローダー\n */\n\n/**\n * HTML文字列をコンテンツとして設定\n * @param html HTML文字列\n * @param content コンテンツ要素\n */\nexport function loadHtml(html: string, content: HTMLElement): void {\n  content.innerHTML = html;\n}\n","/**\n * <dialog>要素を使ったモーダルポップアップ\n *\n */\n\n// import '../css/modal-dialog.scss';\nimport { SygModalUI } from './SygModalUI';\nimport type { TModalDialogType, TModalDialogOption } from './types';\nimport { loadYoutube, loadImage, loadAjax, loadSelector, loadHtml, type ImageDragListeners } from './loaders';\n\nexport type { TModalDialogOption, TModalDialogType };\n\nexport class SygModalDialog {\n  private static currentModalUI: SygModalUI | null = null;\n  private static boundSelectors: Set<string> = new Set();\n  private static delegateListener: ((e: Event) => void) | null = null;\n  private static imageDragListeners: ImageDragListeners | null = null;\n\n  /**\n   * 要素をバインドしてクリックイベントを設定（イベント委譲方式）\n   * 動的に追加された要素にも自動対応し、重複登録を防ぎます\n   */\n  static bind(selector: string, options: TModalDialogOption = {}): void {\n    // 既にバインド済みのセレクタは再登録しない\n    if (this.boundSelectors.has(selector)) {\n      return;\n    }\n\n    this.boundSelectors.add(selector);\n\n    // 初回のみdocumentにイベントリスナーを設定\n    if (!this.delegateListener) {\n      this.delegateListener = (e: Event) => {\n        const target = e.target as HTMLElement;\n        \n        // バインド済みのセレクタのいずれかにマッチするか確認\n        for (const sel of this.boundSelectors) {\n          const matchedElement = target.closest(sel) as HTMLElement;\n          \n          if (matchedElement) {\n            e.preventDefault();\n\n            // src の取得（data-syg-modal-src 優先、なければ href）\n            let src = matchedElement.getAttribute('data-syg-modal-src');\n            if (!src && matchedElement.tagName === 'A') {\n              const anchor = matchedElement as HTMLAnchorElement;\n              // hrefが#で始まる場合はhashを使用（完全なURLにならないように）\n              src = anchor.getAttribute('href') || anchor.href;\n            }\n\n            // type の取得\n            const typeAttr = matchedElement.getAttribute('data-syg-modal');\n            const type = typeAttr && typeAttr !== '' ? (typeAttr as TModalDialogType) : undefined;\n\n            if (!src) {\n              console.error('data-syg-modal-src または href が指定されていません');\n              return;\n            }\n\n            this.showModal({\n              ...options,\n              src,\n              type,\n            });\n            \n            break;\n          }\n        }\n      };\n\n      document.addEventListener('click', this.delegateListener);\n    }\n  }\n\n  /**\n   * モーダルを表示\n   */\n  static showModal(options: TModalDialogOption): void {\n    const { src, type, html } = options;\n\n    // type=\"html\"の場合はhtmlが必須、それ以外はsrcが必須\n    if (type === 'html') {\n      if (!html) {\n        console.error('type=\"html\"の場合、htmlプロパティが必要です');\n        return;\n      }\n    } else if (!src) {\n      console.error('srcが指定されていません');\n      return;\n    }\n\n    const contentType = type || (src ? this.detectType(src) : null);\n\n    if (!contentType) {\n      console.error('コンテンツタイプが判別できません');\n      return;\n    }\n\n    // すでにモーダルが開いている場合はコンテンツだけ入れ替え\n    if (this.currentModalUI && this.currentModalUI.isOpen()) {\n      this.updateContent(src || '', options);\n      return;\n    }\n\n    // SygModalUIを作成\n    this.currentModalUI = new SygModalUI({\n      ...options,\n      onClose: () => {\n        // ドラッグイベントリスナーをクリーンアップ\n        this.cleanupImageDragListeners();\n        \n        // onCloseコールバック\n        if (options.onClose) {\n          options.onClose();\n        }\n\n        // SygModalUIを破棄\n        if (this.currentModalUI) {\n          this.currentModalUI.destroy();\n          this.currentModalUI = null;\n        }\n      },\n    });\n\n    // タイプを設定\n    this.currentModalUI.setType(contentType);\n\n    // モーダルを開く\n    this.currentModalUI.open();\n\n    // コンテンツを読み込み\n    this.loadContent(src || '', contentType, options);\n  }\n\n  /**\n   * コンテンツタイプを自動判別\n   */\n  private static detectType(src: string): TModalDialogType | null {\n    if (/^https?:\\/\\/(www\\.)?(youtube\\.com|youtu\\.be)\\//.test(src)) {\n      return 'youtube';\n    }\n    if (/^[.#]/.test(src)) {\n      return 'selector';\n    }\n    if (/\\.(jpe?g|png|gif|webp)$/i.test(src)) {\n      return 'image';\n    }\n    if (/^https?:\\/\\//.test(src)) {\n      return 'ajax';\n    }\n    return null;\n  }\n\n  /**\n   * 画像のドラッグイベントリスナーをクリーンアップ\n   */\n  private static cleanupImageDragListeners(): void {\n    if (!this.imageDragListeners) return;\n\n    const { doDrag, endDrag, startDrag, touchStart, touchMove, touchEnd, onResizeHandler, rafId } = this.imageDragListeners;\n\n    // アニメーションフレームをキャンセル\n    if (rafId !== null && rafId !== undefined) {\n      cancelAnimationFrame(rafId);\n    }\n\n    if (this.currentModalUI) {\n      const container = this.currentModalUI.getContainer();\n      container.removeEventListener('mousedown', startDrag);\n      container.removeEventListener('touchstart', touchStart);\n    }\n\n    document.removeEventListener('mousemove', doDrag);\n    document.removeEventListener('touchmove', touchMove);\n    document.removeEventListener('mouseup', endDrag);\n    document.removeEventListener('touchend', touchEnd);\n    document.removeEventListener('touchcancel', touchEnd);\n    window.removeEventListener('resize', onResizeHandler);\n\n    this.imageDragListeners = null;\n  }\n\n  /**\n   * コンテンツを読み込み\n   */\n  private static async loadContent(src: string, type: TModalDialogType, options?: TModalDialogOption): Promise<void> {\n    if (!this.currentModalUI) return;\n\n    const content = this.currentModalUI.getContent();\n    const dialog = this.currentModalUI.getDialog();\n    const container = this.currentModalUI.getContainer();\n\n    // 既存のコンテンツをクリア\n    content.innerHTML = '';\n\n    // ローディング開始\n    this.currentModalUI.setLoadingState('loading');\n\n    try {\n      switch (type) {\n        case 'youtube':\n          await loadYoutube(src, content);\n          break;\n        case 'image':\n          this.imageDragListeners = await loadImage(src, content, dialog, container);\n          break;\n        case 'ajax':\n          await loadAjax(src, content);\n          break;\n        case 'selector':\n          loadSelector(src, content);\n          break;\n        case 'html':\n          const html = options?.html || src;\n          loadHtml(html, content);\n          break;\n      }\n\n      // ローディング完了\n      this.currentModalUI.setLoadingState('complete');\n    } catch (error) {\n      console.error('コンテンツの読み込みに失敗しました:', error);\n      content.innerHTML = '<p>コンテンツの取得に失敗しました</p>';\n      this.currentModalUI.setLoadingState('complete');\n    }\n  }\n\n  /**\n   * コンテンツを更新（モーダルが開いている状態で別のコンテンツに切り替え）\n   */\n  private static updateContent(src: string, options: TModalDialogOption): void {\n    if (!this.currentModalUI) return;\n\n    const type = options.type || this.detectType(src);\n\n    if (!type) {\n      console.error('コンテンツタイプが判別できません:', src);\n      return;\n    }\n\n    // タイプを更新\n    this.currentModalUI.setType(type);\n\n    // コンテンツを読み込み\n    this.loadContent(src, type, options);\n  }\n}\n"],"names":["_SygModalUI","options","dialog","container","content","form","closeBtn","loading","ev","html","state","type","SygModalUI","loadYoutube","src","videoId","extractYoutubeId","iframe","url","match","loadImage","resolve","reject","img","naturalWidth","naturalHeight","dialogWidth","dialogHeight","aspectRatio","dialogRatio","containerWidth","containerHeight","isZoomed","translateX","translateY","scale","isDragging","dragStartX","dragStartY","mouseDownX","mouseDownY","dragStartTranslateX","dragStartTranslateY","rafId","pendingTranslateX","pendingTranslateY","lastTouchTime","applyTransform","updateTransform","onMouseDown","e","onTouchStart","touch","onMouseMove","deltaX","deltaY","onTouchMove","performZoom","clientX","clientY","dialogRect","clickXInDialog","clickYInDialog","containerLeft","containerTop","clickXInContainer","clickYInContainer","performZoomOut","handlePointerUp","onMouseUp","onResize","newDialogWidth","newDialogHeight","newContainerWidth","newContainerHeight","onTouchEnd","loadAjax","response","loadSelector","element","loadHtml","_SygModalDialog","selector","target","sel","matchedElement","anchor","typeAttr","contentType","doDrag","endDrag","startDrag","touchStart","touchMove","touchEnd","onResizeHandler","error","SygModalDialog"],"mappings":"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"}