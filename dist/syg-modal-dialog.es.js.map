{"version":3,"file":"syg-modal-dialog.es.js","sources":["../src/js/SygModalUI.ts","../src/js/loaders/youtubeLoader.ts","../src/js/loaders/imageLoader.ts","../src/js/loaders/ajaxLoader.ts","../src/js/loaders/selectorLoader.ts","../src/js/loaders/htmlLoader.ts","../src/js/SygModalDialog.ts"],"sourcesContent":["/**\n * SygModalUI\n * モーダルダイアログのUI層\n * <dialog>要素のDOM生成・管理を担当\n */\n\nimport type { TModalUIOption, TModalDialogType, TModalLoadingState } from './types';\n\nexport class SygModalUI {\n  private dialog: HTMLDialogElement;\n  private container: HTMLElement;\n  private content: HTMLElement;\n  private loading: HTMLElement;\n  private options: {\n    closeButtonContent: string;\n    loadingContent: string;\n    modalClass: string;\n    containerClass: string;\n    contentClass: string;\n    closeBtnClass: string;\n    loadingClass: string;\n    onOpen?: () => void;\n    onClose?: () => void;\n  };\n  \n  public static defaultOptions = {\n    closeButtonContent: '×',\n    loadingContent: '',\n    modalClass: 'c-modal',\n    containerClass: 'c-modal__container',\n    contentClass: 'c-modal__content',\n    closeBtnClass: 'c-modal__close-btn',\n    loadingClass: 'c-modal__loading',\n  };\n\n  constructor(options: TModalUIOption = {}) {\n    this.options = {\n      ...SygModalUI.defaultOptions,\n      ...options,\n    };\n\n    // dialog要素を作成\n    this.dialog = this.createDialog();\n    this.container = this.dialog.querySelector(`#syg-modal-container`) as HTMLElement;\n    this.content = this.dialog.querySelector(`#syg-modal-content`) as HTMLElement;\n    this.loading = this.dialog.querySelector(`#syg-modal-loading`) as HTMLElement;\n\n    // イベントリスナーを設定\n    this.setupEventListeners();\n  }\n\n  /**\n   * dialog要素を作成\n   */\n  private createDialog(): HTMLDialogElement {\n    const dialog = document.createElement('dialog');\n    dialog.id = 'syg-modal-dialog';\n    dialog.className = this.options.modalClass;\n\n    const container = document.createElement('div');\n    container.id = 'syg-modal-container';\n    container.className = this.options.containerClass;\n\n    const content = document.createElement('div');\n    content.id = 'syg-modal-content';\n    content.className = this.options.contentClass;\n\n    const form = document.createElement('form');\n    form.method = 'dialog';\n\n    const closeBtn = document.createElement('button');\n    closeBtn.type = 'submit';\n    closeBtn.className = this.options.closeBtnClass;\n    closeBtn.innerHTML = this.options.closeButtonContent;\n\n    form.appendChild(closeBtn);\n\n    const loading = document.createElement('div');\n    loading.id = 'syg-modal-loading';\n    loading.className = this.options.loadingClass;\n    loading.setAttribute('data-state', 'init');\n    loading.innerHTML = this.options.loadingContent;\n\n    container.appendChild(content);\n    dialog.appendChild(container);\n    dialog.appendChild(form);\n    dialog.appendChild(loading);\n\n    return dialog;\n  }\n\n  /**\n   * イベントリスナーを設定\n   */\n  private setupEventListeners(): void {\n    // 背景クリックで閉じる\n    this.dialog.addEventListener('click', (ev) => {\n      if (ev.target === this.dialog) {\n        this.close();\n      }\n    });\n\n    // closeイベント\n    this.dialog.addEventListener('close', () => {\n      // スクロールを戻す\n      document.documentElement.style.overflow = '';\n      document.documentElement.style.height = '';\n\n      // onCloseコールバック\n      if (this.options.onClose) {\n        this.options.onClose();\n      }\n    });\n  }\n\n  /**\n   * モーダルを開く\n   */\n  open(): void {\n    // bodyに追加（まだ追加されていない場合）\n    if (!this.dialog.parentElement) {\n      document.body.appendChild(this.dialog);\n    }\n\n    // モーダルを表示\n    this.dialog.showModal();\n\n    // 背景スクロールを止める\n    document.documentElement.style.overflow = 'hidden';\n    document.documentElement.style.height = '100vh';\n\n    // onOpenコールバック\n    if (this.options.onOpen) {\n      this.options.onOpen();\n    }\n  }\n\n  /**\n   * モーダルを閉じる\n   */\n  close(): void {\n    this.dialog.close();\n  }\n\n  /**\n   * コンテンツを設定\n   */\n  setContent(html: string): void {\n    this.content.innerHTML = html;\n  }\n\n  /**\n   * ローディング状態を設定\n   */\n  setLoadingState(state: TModalLoadingState): void {\n    this.loading.setAttribute('data-state', state);\n  }\n\n  /**\n   * タイプを設定（data属性とクラス名を更新）\n   */\n  setType(type: TModalDialogType): void {\n    this.dialog.setAttribute('data-syg-modal-type', type);\n    \n    // ajax/selectorの場合はcontentClassを適用、それ以外は削除\n    if (type === 'ajax' || type === 'selector') {\n      this.content.className = this.options.contentClass;\n    } else {\n      this.content.className = '';\n    }\n  }\n\n  /**\n   * dialog要素を取得\n   */\n  getDialog(): HTMLDialogElement {\n    return this.dialog;\n  }\n\n  /**\n   * container要素を取得\n   */\n  getContainer(): HTMLElement {\n    return this.container;\n  }\n\n  /**\n   * content要素を取得\n   */\n  getContent(): HTMLElement {\n    return this.content;\n  }\n\n  /**\n   * loading要素を取得\n   */\n  getLoading(): HTMLElement {\n    return this.loading;\n  }\n\n  /**\n   * モーダルが開いているかどうか\n   */\n  isOpen(): boolean {\n    return this.dialog.open;\n  }\n\n  /**\n   * リソースを破棄\n   */\n  destroy(): void {\n    if (this.dialog.parentElement) {\n      this.dialog.remove();\n    }\n  }\n}\n","/**\n * YouTube動画ローダー\n */\n\n/**\n * YouTube動画を読み込み\n */\nexport async function loadYoutube(src: string, content: HTMLElement): Promise<void> {\n  const videoId = extractYoutubeId(src);\n\n  if (!videoId) {\n    throw new Error('YouTube動画IDを取得できませんでした');\n  }\n\n  const iframe = document.createElement('iframe');\n  iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;\n  iframe.width = '560';\n  iframe.height = '315';\n  iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';\n  iframe.allowFullscreen = true;\n  iframe.style.maxWidth = '100%';\n\n  content.innerHTML = '';\n  content.appendChild(iframe);\n}\n\n/**\n * YouTube動画IDを抽出\n */\nfunction extractYoutubeId(url: string): string | null {\n  // youtube.com/watch?v=VIDEO_ID\n  let match = url.match(/[?&]v=([^&]+)/);\n  if (match?.[1]) return match[1];\n\n  // youtu.be/VIDEO_ID\n  match = url.match(/youtu\\.be\\/([^?&]+)/);\n  if (match?.[1]) return match[1];\n\n  // youtube.com/embed/VIDEO_ID\n  match = url.match(/youtube\\.com\\/embed\\/([^?&]+)/);\n  if (match?.[1]) return match[1];\n\n  return null;\n}\n","/**\n * 画像ローダー\n * ズーム・ドラッグ機能付き\n */\n\nexport type ImageDragListeners = {\n  startDrag: (e: MouseEvent) => void;\n  doDrag: (e: MouseEvent) => void;\n  endDrag: (e: MouseEvent) => void;\n  touchStart: (e: TouchEvent) => void;\n  touchMove: (e: TouchEvent) => void;\n  touchEnd: (e: TouchEvent) => void;\n  onResizeHandler: () => void;\n  rafId: number | null;\n};\n\n/**\n * 画像を読み込み\n */\nexport async function loadImage(\n  src: string,\n  content: HTMLElement,\n  dialog: HTMLDialogElement,\n  container: HTMLElement\n): Promise<ImageDragListeners> {\n  return new Promise((resolve, reject) => {\n    const img = document.createElement('img');\n    img.style.cursor = 'pointer';\n\n    img.onload = () => {\n      // naturalWidth/Heightを取得\n      const naturalWidth = img.naturalWidth;\n      const naturalHeight = img.naturalHeight;\n\n      // syg-modal-dialog のサイズを取得\n      const dialogWidth = dialog.clientWidth;\n      const dialogHeight = dialog.clientHeight;\n\n      // 画像がdialogに収まるようにcontainerのサイズを計算（object-fit:contain相当）\n      // ただし、画像が小さい場合は拡大しない\n      const aspectRatio = naturalWidth / naturalHeight;\n      const dialogRatio = dialogWidth / dialogHeight;\n\n      let containerWidth: number;\n      let containerHeight: number;\n\n      if (aspectRatio > dialogRatio) {\n        // 横長の画像\n        containerWidth = Math.min(dialogWidth, naturalWidth);\n        containerHeight = containerWidth / aspectRatio;\n      } else {\n        // 縦長の画像\n        containerHeight = Math.min(dialogHeight, naturalHeight);\n        containerWidth = containerHeight * aspectRatio;\n      }\n\n      // containerのサイズと中央配置\n      container.style.width = `${containerWidth}px`;\n      container.style.height = `${containerHeight}px`;\n      container.style.left = `${(dialogWidth - containerWidth) / 2}px`;\n      container.style.top = `${(dialogHeight - containerHeight) / 2}px`;\n      container.style.transformOrigin = '0 0';\n\n      // ズーム・ドラッグ用の変数\n      let isZoomed = false;\n      let translateX = 0;\n      let translateY = 0;\n      let scale = 1;\n      let isDragging = false;\n      let dragStartX = 0;\n      let dragStartY = 0;\n      let mouseDownX = 0;\n      let mouseDownY = 0;\n      let dragStartTranslateX = 0;\n      let dragStartTranslateY = 0;\n      let rafId: number | null = null;\n      let pendingTranslateX = 0;\n      let pendingTranslateY = 0;\n      let lastTouchTime = 0; // タッチイベント発火時刻を記録\n\n      // matrixを適用する関数\n      const applyTransform = () => {\n        // matrix(scaleX, skewY, skewX, scaleY, translateX, translateY)\n        container.style.transform = `matrix(${scale}, 0, 0, ${scale}, ${translateX}, ${translateY})`;\n      };\n\n      // requestAnimationFrameを使った更新\n      const updateTransform = () => {\n        translateX = pendingTranslateX;\n        translateY = pendingTranslateY;\n        applyTransform();\n        rafId = null;\n      };\n\n      // マウスダウン\n      const onMouseDown = (e: MouseEvent) => {\n        // タッチイベントの直後（500ms以内）ならマウスイベントを無視\n        if (Date.now() - lastTouchTime < 500) {\n          return;\n        }\n        \n        if (e.target !== container && e.target !== img) return;\n\n        isDragging = true;\n        mouseDownX = e.clientX;\n        mouseDownY = e.clientY;\n        dragStartX = e.clientX;\n        dragStartY = e.clientY;\n        dragStartTranslateX = translateX;\n        dragStartTranslateY = translateY;\n        container.style.cursor = isZoomed ? 'grabbing' : 'pointer';\n      };\n\n      // タッチスタート\n      const onTouchStart = (e: TouchEvent) => {\n        if (e.target !== container && e.target !== img) return;\n        if (e.touches.length !== 1) return;\n\n        lastTouchTime = Date.now(); // タッチ時刻を記録\n        e.preventDefault(); // デフォルト動作を防止（クリックイベントの発火を防ぐ）\n        const touch = e.touches[0];\n        if (!touch) return;\n        isDragging = true;\n        mouseDownX = touch.clientX;\n        mouseDownY = touch.clientY;\n        dragStartX = touch.clientX;\n        dragStartY = touch.clientY;\n        dragStartTranslateX = translateX;\n        dragStartTranslateY = translateY;\n      };\n\n      // マウスムーブ\n      const onMouseMove = (e: MouseEvent) => {\n        if (!isDragging) return;\n\n        const deltaX = e.clientX - dragStartX;\n        const deltaY = e.clientY - dragStartY;\n\n        // ズーム時のみドラッグで移動\n        if (isZoomed) {\n          pendingTranslateX = dragStartTranslateX + deltaX;\n          pendingTranslateY = dragStartTranslateY + deltaY;\n          \n          // requestAnimationFrameが未実行なら予約\n          if (rafId === null) {\n            rafId = requestAnimationFrame(updateTransform);\n          }\n        }\n      };\n\n      // タッチムーブ\n      const onTouchMove = (e: TouchEvent) => {\n        if (!isDragging) return;\n        if (e.touches.length !== 1) return;\n\n        const touch = e.touches[0];\n        if (!touch) return;\n        const deltaX = touch.clientX - dragStartX;\n        const deltaY = touch.clientY - dragStartY;\n\n        // ズーム時のみドラッグで移動\n        if (isZoomed) {\n          e.preventDefault(); // スクロール防止\n          pendingTranslateX = dragStartTranslateX + deltaX;\n          pendingTranslateY = dragStartTranslateY + deltaY;\n          \n          // requestAnimationFrameが未実行なら予約\n          if (rafId === null) {\n            rafId = requestAnimationFrame(updateTransform);\n          }\n        }\n      };\n\n      // 共通: ズーム処理\n      const performZoom = (clientX: number, clientY: number) => {\n        isZoomed = true;\n        scale = naturalWidth / containerWidth;\n\n        // dialog の位置\n        const dialogRect = dialog.getBoundingClientRect();\n        \n        // クリック位置（dialog内の座標）\n        const clickXInDialog = clientX - dialogRect.left;\n        const clickYInDialog = clientY - dialogRect.top;\n\n        // containerの左上座標（dialog内、transform適用前の位置）\n        const containerLeft = parseFloat(container.style.left);\n        const containerTop = parseFloat(container.style.top);\n\n        // クリック位置（container内の座標）\n        const clickXInContainer = clickXInDialog - containerLeft;\n        const clickYInContainer = clickYInDialog - containerTop;\n        \n        translateX = clickXInContainer * (1 - scale);\n        translateY = clickYInContainer * (1 - scale);\n\n        container.style.cursor = 'grab';\n        applyTransform();\n      };\n\n      // 共通: ズーム解除処理\n      const performZoomOut = () => {\n        isZoomed = false;\n        scale = 1;\n        translateX = 0;\n        translateY = 0;\n        container.style.cursor = 'pointer';\n        applyTransform();\n      };\n\n      // 共通: クリック/タップ終了処理\n      const handlePointerUp = (clientX: number, clientY: number) => {\n        if (!isDragging) return;\n\n        // 保留中のアニメーションフレームをキャンセル\n        if (rafId !== null) {\n          cancelAnimationFrame(rafId);\n          rafId = null;\n        }\n\n        const moveDistance = Math.sqrt(\n          Math.pow(clientX - mouseDownX, 2) + Math.pow(clientY - mouseDownY, 2)\n        );\n\n        // 5px未満の移動ならクリック/タップとみなす\n        if (moveDistance < 5) {\n          if (isZoomed) {\n            performZoomOut();\n          } else {\n            performZoom(clientX, clientY);\n          }\n        } else {\n          // ドラッグ終了時に最終位置を反映\n          translateX = pendingTranslateX;\n          translateY = pendingTranslateY;\n        }\n\n        isDragging = false;\n        if (isZoomed) {\n          container.style.cursor = 'grab';\n        }\n      };\n\n      // マウスアップ\n      const onMouseUp = (e: MouseEvent) => {\n        handlePointerUp(e.clientX, e.clientY);\n      };\n\n      // ウィンドウリサイズ時の処理\n      const onResize = () => {\n        // ズーム中はリサイズ処理をスキップ\n        if (isZoomed) return;\n\n        // dialog の新しいサイズを取得\n        const newDialogWidth = dialog.clientWidth;\n        const newDialogHeight = dialog.clientHeight;\n\n        // containerのサイズを再計算\n        const aspectRatio = naturalWidth / naturalHeight;\n        const dialogRatio = newDialogWidth / newDialogHeight;\n\n        let newContainerWidth: number;\n        let newContainerHeight: number;\n\n        if (aspectRatio > dialogRatio) {\n          // 横長の画像\n          newContainerWidth = Math.min(newDialogWidth, naturalWidth);\n          newContainerHeight = newContainerWidth / aspectRatio;\n        } else {\n          // 縦長の画像\n          newContainerHeight = Math.min(newDialogHeight, naturalHeight);\n          newContainerWidth = newContainerHeight * aspectRatio;\n        }\n\n        // containerを中央に配置\n        container.style.width = `${newContainerWidth}px`;\n        container.style.height = `${newContainerHeight}px`;\n        container.style.left = `${(newDialogWidth - newContainerWidth) / 2}px`;\n        container.style.top = `${(newDialogHeight - newContainerHeight) / 2}px`;\n\n        // containerWidth/Heightを更新（ズーム時の計算に使用）\n        containerWidth = newContainerWidth;\n        containerHeight = newContainerHeight;\n      };\n\n      // タッチエンド\n      const onTouchEnd = (e: TouchEvent) => {\n        if (!isDragging) return;\n        e.preventDefault(); // デフォルト動作を防止（クリックイベントの発火を防ぐ）\n        const touch = e.changedTouches[0];\n        if (!touch) return;\n        handlePointerUp(touch.clientX, touch.clientY);\n      };\n\n      // イベントリスナーを追加\n      container.addEventListener('mousedown', onMouseDown);\n      container.addEventListener('touchstart', onTouchStart, { passive: false });\n      document.addEventListener('mousemove', onMouseMove);\n      document.addEventListener('touchmove', onTouchMove, { passive: false });\n      document.addEventListener('mouseup', onMouseUp);\n      document.addEventListener('touchend', onTouchEnd);\n      document.addEventListener('touchcancel', onTouchEnd);\n      window.addEventListener('resize', onResize);\n\n      // 画像をコンテンツに追加\n      content.innerHTML = '';\n      content.appendChild(img);\n\n      // ドラッグリスナーを返す\n      resolve({\n        startDrag: onMouseDown,\n        doDrag: onMouseMove,\n        endDrag: onMouseUp,\n        touchStart: onTouchStart,\n        touchMove: onTouchMove,\n        touchEnd: onTouchEnd,\n        onResizeHandler: onResize,\n        rafId,\n      });\n    };\n\n    img.onerror = () => reject(new Error('画像の読み込みに失敗しました'));\n\n    img.src = src;\n  });\n}\n","/**\n * Ajax コンテンツローダー\n */\n\n/**\n * Ajaxでコンテンツを読み込み\n */\nexport async function loadAjax(src: string, content: HTMLElement): Promise<void> {\n  const response = await fetch(src);\n\n  if (!response.ok) {\n    throw new Error(`HTTP error! status: ${response.status}`);\n  }\n\n  const html = await response.text();\n  content.innerHTML = html;\n}\n","/**\n * セレクタコンテンツローダー\n */\n\n/**\n * セレクタで指定した要素のコンテンツを読み込み\n */\nexport function loadSelector(src: string, content: HTMLElement): void {\n  const element = document.querySelector(src);\n\n  if (!element) {\n    throw new Error(`要素が見つかりません: ${src}`);\n  }\n\n  content.innerHTML = element.innerHTML;\n}\n","/**\n * HTML文字列を直接表示するローダー\n */\n\n/**\n * HTML文字列をコンテンツとして設定\n * @param html HTML文字列\n * @param content コンテンツ要素\n */\nexport function loadHtml(html: string, content: HTMLElement): void {\n  content.innerHTML = html;\n}\n","/**\n * <dialog>要素を使ったモーダルポップアップ\n *\n */\n\n// import '../css/modal-dialog.scss';\nimport { SygModalUI } from './SygModalUI';\nimport type { TModalDialogType, TModalDialogOption } from './types';\nimport { loadYoutube, loadImage, loadAjax, loadSelector, loadHtml, type ImageDragListeners } from './loaders';\n\nexport type { TModalDialogOption, TModalDialogType };\n\nexport class SygModalDialog {\n  private static currentModalUI: SygModalUI | null = null;\n  private static boundSelectors: Set<string> = new Set();\n  private static delegateListener: ((e: Event) => void) | null = null;\n  private static imageDragListeners: ImageDragListeners | null = null;\n\n  /**\n   * 要素をバインドしてクリックイベントを設定（イベント委譲方式）\n   * 動的に追加された要素にも自動対応し、重複登録を防ぎます\n   */\n  static bind(selector: string, options: TModalDialogOption = {}): void {\n    // 既にバインド済みのセレクタは再登録しない\n    if (this.boundSelectors.has(selector)) {\n      return;\n    }\n\n    this.boundSelectors.add(selector);\n\n    // 初回のみdocumentにイベントリスナーを設定\n    if (!this.delegateListener) {\n      this.delegateListener = (e: Event) => {\n        const target = e.target as HTMLElement;\n        \n        // バインド済みのセレクタのいずれかにマッチするか確認\n        for (const sel of this.boundSelectors) {\n          const matchedElement = target.closest(sel) as HTMLElement;\n          \n          if (matchedElement) {\n            e.preventDefault();\n\n            // src の取得（data-syg-modal-src 優先、なければ href）\n            let src = matchedElement.getAttribute('data-syg-modal-src');\n            if (!src && matchedElement.tagName === 'A') {\n              const anchor = matchedElement as HTMLAnchorElement;\n              // hrefが#で始まる場合はhashを使用（完全なURLにならないように）\n              src = anchor.getAttribute('href') || anchor.href;\n            }\n\n            // type の取得\n            const typeAttr = matchedElement.getAttribute('data-syg-modal');\n            const type = typeAttr && typeAttr !== '' ? (typeAttr as TModalDialogType) : undefined;\n\n            if (!src) {\n              console.error('data-syg-modal-src または href が指定されていません');\n              return;\n            }\n\n            this.showModal({\n              ...options,\n              src,\n              type,\n            });\n            \n            break;\n          }\n        }\n      };\n\n      document.addEventListener('click', this.delegateListener);\n    }\n  }\n\n  /**\n   * モーダルを表示\n   */\n  static showModal(options: TModalDialogOption): void {\n    const { src, type, html } = options;\n\n    // type=\"html\"の場合はhtmlが必須、それ以外はsrcが必須\n    if (type === 'html') {\n      if (!html) {\n        console.error('type=\"html\"の場合、htmlプロパティが必要です');\n        return;\n      }\n    } else if (!src) {\n      console.error('srcが指定されていません');\n      return;\n    }\n\n    const contentType = type || (src ? this.detectType(src) : null);\n\n    if (!contentType) {\n      console.error('コンテンツタイプが判別できません');\n      return;\n    }\n\n    // すでにモーダルが開いている場合はコンテンツだけ入れ替え\n    if (this.currentModalUI && this.currentModalUI.isOpen()) {\n      this.updateContent(src || '', options);\n      return;\n    }\n\n    // SygModalUIを作成\n    this.currentModalUI = new SygModalUI({\n      ...options,\n      onClose: () => {\n        // ドラッグイベントリスナーをクリーンアップ\n        this.cleanupImageDragListeners();\n        \n        // onCloseコールバック\n        if (options.onClose) {\n          options.onClose();\n        }\n\n        // SygModalUIを破棄\n        if (this.currentModalUI) {\n          this.currentModalUI.destroy();\n          this.currentModalUI = null;\n        }\n      },\n    });\n\n    // タイプを設定\n    this.currentModalUI.setType(contentType);\n\n    // モーダルを開く\n    this.currentModalUI.open();\n\n    // コンテンツを読み込み\n    this.loadContent(src || '', contentType, options);\n  }\n\n  /**\n   * コンテンツタイプを自動判別\n   */\n  private static detectType(src: string): TModalDialogType | null {\n    if (/^https?:\\/\\/(www\\.)?(youtube\\.com|youtu\\.be)\\//.test(src)) {\n      return 'youtube';\n    }\n    if (/^[.#]/.test(src)) {\n      return 'selector';\n    }\n    if (/\\.(jpe?g|png|gif|webp)$/i.test(src)) {\n      return 'image';\n    }\n    if (/^https?:\\/\\//.test(src)) {\n      return 'ajax';\n    }\n    return null;\n  }\n\n  /**\n   * 画像のドラッグイベントリスナーをクリーンアップ\n   */\n  private static cleanupImageDragListeners(): void {\n    if (!this.imageDragListeners) return;\n\n    const { doDrag, endDrag, startDrag, touchStart, touchMove, touchEnd, onResizeHandler, rafId } = this.imageDragListeners;\n\n    // アニメーションフレームをキャンセル\n    if (rafId !== null && rafId !== undefined) {\n      cancelAnimationFrame(rafId);\n    }\n\n    if (this.currentModalUI) {\n      const container = this.currentModalUI.getContainer();\n      container.removeEventListener('mousedown', startDrag);\n      container.removeEventListener('touchstart', touchStart);\n    }\n\n    document.removeEventListener('mousemove', doDrag);\n    document.removeEventListener('touchmove', touchMove);\n    document.removeEventListener('mouseup', endDrag);\n    document.removeEventListener('touchend', touchEnd);\n    document.removeEventListener('touchcancel', touchEnd);\n    window.removeEventListener('resize', onResizeHandler);\n\n    this.imageDragListeners = null;\n  }\n\n  /**\n   * コンテンツを読み込み\n   */\n  private static async loadContent(src: string, type: TModalDialogType, options?: TModalDialogOption): Promise<void> {\n    if (!this.currentModalUI) return;\n\n    const content = this.currentModalUI.getContent();\n    const dialog = this.currentModalUI.getDialog();\n    const container = this.currentModalUI.getContainer();\n\n    // 既存のコンテンツをクリア\n    content.innerHTML = '';\n\n    // ローディング開始\n    this.currentModalUI.setLoadingState('loading');\n\n    try {\n      switch (type) {\n        case 'youtube':\n          await loadYoutube(src, content);\n          break;\n        case 'image':\n          this.imageDragListeners = await loadImage(src, content, dialog, container);\n          break;\n        case 'ajax':\n          await loadAjax(src, content);\n          break;\n        case 'selector':\n          loadSelector(src, content);\n          break;\n        case 'html':\n          const html = options?.html || src;\n          loadHtml(html, content);\n          break;\n      }\n\n      // ローディング完了\n      this.currentModalUI.setLoadingState('complete');\n    } catch (error) {\n      console.error('コンテンツの読み込みに失敗しました:', error);\n      content.innerHTML = '<p>コンテンツの取得に失敗しました</p>';\n      this.currentModalUI.setLoadingState('complete');\n    }\n  }\n\n  /**\n   * コンテンツを更新（モーダルが開いている状態で別のコンテンツに切り替え）\n   */\n  private static updateContent(src: string, options: TModalDialogOption): void {\n    if (!this.currentModalUI) return;\n\n    const type = options.type || this.detectType(src);\n\n    if (!type) {\n      console.error('コンテンツタイプが判別できません:', src);\n      return;\n    }\n\n    // タイプを更新\n    this.currentModalUI.setType(type);\n\n    // コンテンツを読み込み\n    this.loadContent(src, type, options);\n  }\n}\n"],"names":["_SygModalUI","options","dialog","container","content","form","closeBtn","loading","ev","html","state","type","SygModalUI","loadYoutube","src","videoId","extractYoutubeId","iframe","url","match","loadImage","resolve","reject","img","naturalWidth","naturalHeight","dialogWidth","dialogHeight","aspectRatio","dialogRatio","containerWidth","containerHeight","isZoomed","translateX","translateY","scale","isDragging","dragStartX","dragStartY","mouseDownX","mouseDownY","dragStartTranslateX","dragStartTranslateY","rafId","pendingTranslateX","pendingTranslateY","lastTouchTime","applyTransform","updateTransform","onMouseDown","e","onTouchStart","touch","onMouseMove","deltaX","deltaY","onTouchMove","performZoom","clientX","clientY","dialogRect","clickXInDialog","clickYInDialog","containerLeft","containerTop","clickXInContainer","clickYInContainer","performZoomOut","handlePointerUp","onMouseUp","onResize","newDialogWidth","newDialogHeight","newContainerWidth","newContainerHeight","onTouchEnd","loadAjax","response","loadSelector","element","loadHtml","_SygModalDialog","selector","target","sel","matchedElement","anchor","typeAttr","contentType","doDrag","endDrag","startDrag","touchStart","touchMove","touchEnd","onResizeHandler","error","SygModalDialog"],"mappings":"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"}